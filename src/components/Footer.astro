---
const currentYear = new Date().getFullYear();

const socialLinks = [
  { 
    name: "Facebook", 
    href: "https://www.facebook.com/teamemailrakyat", 
    icon: "M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z" 
  },
  { 
    name: "Instagram", 
    href: "https://www.instagram.com/teamemailrakyat/", 
    icon: "M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37zm1.5-4.87h.01M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 01-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 017.8 2m0 2a3.8 3.8 0 00-3.8 3.8v8.4A3.8 3.8 0 007.8 20h8.4a3.8 3.8 0 003.8-3.8V7.8A3.8 3.8 0 0016.2 4H7.8z" 
  },
  { 
    name: "TikTok", 
    href: "https://www.tiktok.com/@raja.emel?is_from_webapp=1&sender_device=pc", 
    icon: "M12.5 5.5v8.7a2.7 2.7 0 11-2.7-2.7h.5V9a5.2 5.2 0 105.2 5.2V7.6c1 .4 2.1.5 3.2.3v-2.5c-.9 0-1.8-.3-2.5-.8-.6-.5-1.1-1.2-1.3-1.9h-2.4z" 
  },
  { 
    name: "YouTube", 
    href: "https://www.youtube.com/@emailrakyat", 
    icon: "M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" 
  },
  { 
    name: "Email", 
    href: "https://mail.google.com/mail/?view=cm&fs=1&to=aduan@e-rakyat.com", 
    icon: "M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z m16 3.38V6H4v1.38l8 4 8-4zM4 18h16v-8.38l-8 4-8-4V18z" 
  }
];

const securityFeatures = [
  { name: "HTTPS / TLS Encryption", status: "ACTIVE", color: "text-green-500" },
  { name: "HSTS Protection", status: "ENFORCED", color: "text-green-500" },
  { name: "X-Frame Anti-Clickjack", status: "DENY", color: "text-green-500" },
  { name: "Cloudflare Shield", status: "STANDBY", color: "text-yellow-500" },
];
---

<footer class="bg-black text-gray-400 border-t border-gray-800 pt-12 pb-8 mt-auto relative z-30">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <div class="flex flex-col items-center mb-10">
      <h3 class="text-xs font-bold text-yellow-500 uppercase tracking-[0.2em] mb-6">
        Ikuti Kami Di Media Sosial
      </h3>
      
      <div class="flex flex-wrap justify-center gap-6 md:gap-8">
        {socialLinks.map((link) => (
          <a 
            href={link.href} 
            target="_blank"
            rel="noopener noreferrer"
            class="group relative flex items-center justify-center w-12 h-12 rounded-lg bg-gray-900 border border-gray-800 hover:border-yellow-500 hover:bg-yellow-500 hover:text-black transition-all duration-300"
            aria-label={link.name}
          >
            <svg 
              xmlns="http://www.w3.org/2000/svg" 
              width="20" 
              height="20" 
              viewBox="0 0 24 24" 
              fill={link.name === "Facebook" || link.name === "TikTok" || link.name === "YouTube" || link.name === "Email" ? "currentColor" : "none"}
              stroke={link.name === "Instagram" ? "currentColor" : "none"}
              stroke-width={link.name === "Instagram" ? "2" : "0"}
              stroke-linecap="round" 
              stroke-linejoin="round"
              class="transition-transform group-hover:scale-110"
            >
              <path d={link.icon}></path>
            </svg>
            <span class="absolute -bottom-8 opacity-0 group-hover:opacity-100 text-[10px] font-bold uppercase tracking-wider text-yellow-500 transition-opacity duration-300">
              {link.name}
            </span>
          </a>
        ))}
      </div>
    </div>

    <div class="border-t border-gray-800/50 mb-8"></div>

    <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-center md:text-left">
      <div class="text-sm">
        &copy; {currentYear} <span class="text-white font-bold tracking-wide">EMAIL RAKYAT</span>. All rights reserved.
      </div>

      <div class="flex flex-wrap justify-center gap-x-6 gap-y-2 text-xs font-medium uppercase tracking-wide">
        <button id="btn-privacy" class="hover:text-yellow-500 transition-colors focus:outline-none">Privacy Policy</button>
        <button id="btn-terms" class="hover:text-yellow-500 transition-colors focus:outline-none">Terms of Service</button>
        <button id="btn-security" class="hover:text-yellow-500 transition-colors flex items-center gap-2 focus:outline-none">
          Security Status
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
          </span>
        </button>
      </div>
    </div>
  </div>

  <dialog id="modal-privacy" class="backdrop:bg-black/90 backdrop:backdrop-blur-sm bg-transparent p-0 w-full max-w-2xl open:animate-fade-in m-auto bg-gray-900 border border-gray-700 rounded-xl shadow-2xl text-left">
    <div class="relative bg-gray-900 text-gray-300 p-8 max-h-[80vh] overflow-y-auto">
        <button class="close-modal absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
        <h3 class="text-xl font-black text-white mb-4 uppercase tracking-wide border-b border-gray-700 pb-2">Polisi Privasi <span class="text-yellow-500">"Zero-Knowledge"</span></h3>
        <div class="prose prose-invert prose-sm">
            <p><strong>1. Pengumpulan Data:</strong> Kami hanya mengumpul data yang anda berikan secara sukarela. Kami <strong>TIDAK</strong> menggunakan penjejak (trackers) pihak ketiga.</p>
            <p><strong>2. Kerahsiaan:</strong> Maklumat anda tidak akan dijual kepada agensi kutipan hutang atau bank. Data anda disulitkan (Encrypted).</p>
            <p><strong>3. Pemadaman:</strong> Anda berhak memohon pemadaman rekod komunikasi pada bila-bila masa.</p>
        </div>
        <button class="close-modal mt-6 w-full bg-gray-800 hover:bg-yellow-600 hover:text-black text-white font-bold py-2 rounded transition-colors text-sm uppercase">Faham & Tutup</button>
    </div>
  </dialog>

  <dialog id="modal-terms" class="backdrop:bg-black/90 backdrop:backdrop-blur-sm bg-transparent p-0 w-full max-w-2xl open:animate-fade-in m-auto bg-gray-900 border border-gray-700 rounded-xl shadow-2xl text-left">
    <div class="relative bg-gray-900 text-gray-300 p-8 max-h-[80vh] overflow-y-auto">
        <button class="close-modal absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
        <h3 class="text-xl font-black text-white mb-4 uppercase tracking-wide border-b border-gray-700 pb-2">Penafian & <span class="text-yellow-500">Syarat</span></h3>
        <div class="prose prose-invert prose-sm">
            <p><strong>1. Bukan PDRM/Peguam:</strong> Email Rakyat adalah platform khidmat nasihat sosial. Kami bukan pengganti polis atau firma guaman.</p>
            <p><strong>2. Tanggungjawab:</strong> Anda bersetuju memberikan maklumat benar. Laporan palsu tidak akan dilayan.</p>
            <p><strong>3. Liabiliti:</strong> Kami tidak bertanggungjawab atas kerugian yang timbul. Sila rujuk peguam bertauliah untuk tindakan mahkamah.</p>
        </div>
        <button class="close-modal mt-6 w-full bg-gray-800 hover:bg-yellow-600 hover:text-black text-white font-bold py-2 rounded transition-colors text-sm uppercase">Setuju & Tutup</button>
    </div>
  </dialog>

  <dialog id="modal-security" class="backdrop:bg-black/90 backdrop:backdrop-blur-sm bg-transparent p-0 w-full max-w-2xl open:animate-fade-in m-auto bg-gray-900 border border-green-500/30 rounded-xl shadow-[0_0_50px_rgba(34,197,94,0.15)] text-left">
    <div class="relative bg-black text-gray-300 p-8 max-h-[80vh] overflow-y-auto">
        <button class="close-modal absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
        
        <div class="flex items-center gap-3 mb-6 border-b border-gray-800 pb-4">
             <span class="relative flex h-4 w-4">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-4 w-4 bg-green-500"></span>
            </span>
            <h3 class="text-lg font-mono font-bold text-green-500 uppercase tracking-widest">System Operational</h3>
        </div>

        <div class="grid grid-cols-1 gap-3 mb-6">
            {securityFeatures.map(feature => (
                <div class="bg-gray-900/50 p-3 rounded border border-gray-800 flex justify-between items-center">
                    <span class="text-gray-400 font-mono text-xs uppercase">{feature.name}</span>
                    <span class={`font-mono font-bold text-[10px] border px-2 py-0.5 rounded ${feature.color} border-current bg-black`}>
                        {feature.status}
                    </span>
                </div>
            ))}
        </div>

        <div class="text-[10px] font-mono text-gray-600 text-center">
            Encrypted by TLS 1.3 (Military Grade) <br>
            Server Node: Netlify Edge (Global)
        </div>

        <button class="close-modal mt-6 w-full border border-green-500/50 text-green-500 hover:bg-green-500 hover:text-black font-mono font-bold py-2 rounded transition-colors text-xs uppercase">Close Security Log</button>
    </div>
  </dialog>

</footer>

<script>
  // Setup logic with explicit types to clear "Implicit Any" errors
  const setupModal = (btnId: string, modalId: string) => {
    const btn = document.getElementById(btnId);
    const modal = document.getElementById(modalId) as HTMLDialogElement | null;
    
    if (btn && modal) {
      // Open
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        modal.showModal(); 
        document.body.style.overflow = 'hidden'; 
      });

      // Close (Backdrop or Button)
      modal.addEventListener('click', (e) => {
        const dialogDimensions = modal.getBoundingClientRect();
        const target = e.target as HTMLElement; // Safe cast

        // Check if click is outside bounds OR on close button
        if (
          e.clientX < dialogDimensions.left ||
          e.clientX > dialogDimensions.right ||
          e.clientY < dialogDimensions.top ||
          e.clientY > dialogDimensions.bottom ||
          target.classList.contains('close-modal')
        ) {
          modal.close();
          document.body.style.overflow = ''; 
        }
      });
    }
  };

  setupModal('btn-privacy', 'modal-privacy');
  setupModal('btn-terms', 'modal-terms');
  setupModal('btn-security', 'modal-security');
</script>

<style>
  dialog[open] { animation: fadeIn 0.3s ease-out; }
  @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
  
  dialog div::-webkit-scrollbar { width: 6px; }
  dialog div::-webkit-scrollbar-track { background: #111; }
  dialog div::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
</style>